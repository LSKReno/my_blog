<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>003-从输入URL到页面加载显示完成到底发生了什么？——网络篇 | Half Town前端周刊</title>
    <meta name="description" content="白糖炒栗子哒前端Blog">
    <link rel="icon" href="/favicon.ico">
  <link rel="mainfest" href="/mainfest.json">
    
    <link rel="preload" href="/assets/css/0.styles.d4c32f31.css" as="style"><link rel="preload" href="/assets/js/app.b1906b97.js" as="script"><link rel="preload" href="/assets/js/2.bdee5faf.js" as="script"><link rel="preload" href="/assets/js/10.e085a21c.js" as="script"><link rel="preload" href="/assets/js/7.f0379e88.js" as="script"><link rel="preload" href="/assets/js/8.e132ed9d.js" as="script"><link rel="prefetch" href="/assets/js/100.78a0b04f.js"><link rel="prefetch" href="/assets/js/101.02ef3e98.js"><link rel="prefetch" href="/assets/js/102.cdd542e1.js"><link rel="prefetch" href="/assets/js/103.de748a03.js"><link rel="prefetch" href="/assets/js/104.7455cba5.js"><link rel="prefetch" href="/assets/js/105.68a805c9.js"><link rel="prefetch" href="/assets/js/106.a2ff7e85.js"><link rel="prefetch" href="/assets/js/107.36f34ab6.js"><link rel="prefetch" href="/assets/js/108.f26732f6.js"><link rel="prefetch" href="/assets/js/109.8d05e086.js"><link rel="prefetch" href="/assets/js/11.f2fd41dc.js"><link rel="prefetch" href="/assets/js/110.c7f84bd1.js"><link rel="prefetch" href="/assets/js/111.0cdf0d73.js"><link rel="prefetch" href="/assets/js/12.450e705b.js"><link rel="prefetch" href="/assets/js/13.50973e7a.js"><link rel="prefetch" href="/assets/js/14.40fad099.js"><link rel="prefetch" href="/assets/js/15.a2d432ad.js"><link rel="prefetch" href="/assets/js/16.4ad6c82f.js"><link rel="prefetch" href="/assets/js/17.1bc86885.js"><link rel="prefetch" href="/assets/js/18.ade73665.js"><link rel="prefetch" href="/assets/js/19.a0f47a6e.js"><link rel="prefetch" href="/assets/js/20.5499b902.js"><link rel="prefetch" href="/assets/js/21.86afe090.js"><link rel="prefetch" href="/assets/js/22.29fa6f17.js"><link rel="prefetch" href="/assets/js/23.1af6f734.js"><link rel="prefetch" href="/assets/js/24.933ea1dd.js"><link rel="prefetch" href="/assets/js/25.7b5dc5f0.js"><link rel="prefetch" href="/assets/js/26.03194069.js"><link rel="prefetch" href="/assets/js/27.eb1fac5c.js"><link rel="prefetch" href="/assets/js/28.01df134d.js"><link rel="prefetch" href="/assets/js/29.697d4c02.js"><link rel="prefetch" href="/assets/js/3.77f61fb0.js"><link rel="prefetch" href="/assets/js/30.e1b58026.js"><link rel="prefetch" href="/assets/js/31.41db2b44.js"><link rel="prefetch" href="/assets/js/32.9f2db749.js"><link rel="prefetch" href="/assets/js/33.03b6d68a.js"><link rel="prefetch" href="/assets/js/34.09609909.js"><link rel="prefetch" href="/assets/js/35.c80be0ac.js"><link rel="prefetch" href="/assets/js/36.d15e6050.js"><link rel="prefetch" href="/assets/js/37.1ccd8184.js"><link rel="prefetch" href="/assets/js/38.ab0d4b98.js"><link rel="prefetch" href="/assets/js/39.8301eaad.js"><link rel="prefetch" href="/assets/js/4.90b687b0.js"><link rel="prefetch" href="/assets/js/40.d95907af.js"><link rel="prefetch" href="/assets/js/41.33845e14.js"><link rel="prefetch" href="/assets/js/42.8a256266.js"><link rel="prefetch" href="/assets/js/43.343b309f.js"><link rel="prefetch" href="/assets/js/44.e61b9da2.js"><link rel="prefetch" href="/assets/js/45.0eea8be7.js"><link rel="prefetch" href="/assets/js/46.861203d9.js"><link rel="prefetch" href="/assets/js/47.ae5bd907.js"><link rel="prefetch" href="/assets/js/48.1dbfd265.js"><link rel="prefetch" href="/assets/js/49.87f2ea7e.js"><link rel="prefetch" href="/assets/js/5.06355c1f.js"><link rel="prefetch" href="/assets/js/50.92bcf9cd.js"><link rel="prefetch" href="/assets/js/51.2b54e26b.js"><link rel="prefetch" href="/assets/js/52.ef61db16.js"><link rel="prefetch" href="/assets/js/53.e8411588.js"><link rel="prefetch" href="/assets/js/54.6f0a7cd7.js"><link rel="prefetch" href="/assets/js/55.40d0a721.js"><link rel="prefetch" href="/assets/js/56.76ff8ce6.js"><link rel="prefetch" href="/assets/js/57.cfea78e2.js"><link rel="prefetch" href="/assets/js/58.f8c35f3d.js"><link rel="prefetch" href="/assets/js/59.02cbb18a.js"><link rel="prefetch" href="/assets/js/6.d108277e.js"><link rel="prefetch" href="/assets/js/60.2df7b32b.js"><link rel="prefetch" href="/assets/js/61.16805fc4.js"><link rel="prefetch" href="/assets/js/62.ef5ca102.js"><link rel="prefetch" href="/assets/js/63.923718a5.js"><link rel="prefetch" href="/assets/js/64.d40092dd.js"><link rel="prefetch" href="/assets/js/65.d68a358c.js"><link rel="prefetch" href="/assets/js/66.b4323cbe.js"><link rel="prefetch" href="/assets/js/67.3a9004c1.js"><link rel="prefetch" href="/assets/js/68.350f6fbb.js"><link rel="prefetch" href="/assets/js/69.fdebae43.js"><link rel="prefetch" href="/assets/js/70.ccac64ba.js"><link rel="prefetch" href="/assets/js/71.8948f6c8.js"><link rel="prefetch" href="/assets/js/72.f5d07472.js"><link rel="prefetch" href="/assets/js/73.c2ddba1b.js"><link rel="prefetch" href="/assets/js/74.7a96d852.js"><link rel="prefetch" href="/assets/js/75.d452b4b5.js"><link rel="prefetch" href="/assets/js/76.5eac82cb.js"><link rel="prefetch" href="/assets/js/77.49a8f94c.js"><link rel="prefetch" href="/assets/js/78.17478c01.js"><link rel="prefetch" href="/assets/js/79.545a2920.js"><link rel="prefetch" href="/assets/js/80.172aeb42.js"><link rel="prefetch" href="/assets/js/81.6376c78a.js"><link rel="prefetch" href="/assets/js/82.1dfa8f89.js"><link rel="prefetch" href="/assets/js/83.fc10680d.js"><link rel="prefetch" href="/assets/js/84.41df0212.js"><link rel="prefetch" href="/assets/js/85.b57d2894.js"><link rel="prefetch" href="/assets/js/86.1bed09b1.js"><link rel="prefetch" href="/assets/js/87.3bc2e0cf.js"><link rel="prefetch" href="/assets/js/88.5797d5a1.js"><link rel="prefetch" href="/assets/js/89.cfc4d086.js"><link rel="prefetch" href="/assets/js/9.17617c7c.js"><link rel="prefetch" href="/assets/js/90.d3796c5b.js"><link rel="prefetch" href="/assets/js/91.f9e0f122.js"><link rel="prefetch" href="/assets/js/92.8ce6ae6a.js"><link rel="prefetch" href="/assets/js/93.f1c144ce.js"><link rel="prefetch" href="/assets/js/94.1877adf1.js"><link rel="prefetch" href="/assets/js/95.41ce2c18.js"><link rel="prefetch" href="/assets/js/96.07be3e30.js"><link rel="prefetch" href="/assets/js/97.d6ecd209.js"><link rel="prefetch" href="/assets/js/98.b1431a2d.js"><link rel="prefetch" href="/assets/js/99.acea4094.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4c32f31.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Half Town前端周刊</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/posts/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结前端技术文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6-11新特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深入JavaScript系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Browser浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/browser/001-caching-mechanism/" class="sidebar-link">001-浏览器的缓存机制</a></li><li><a href="/browser/002-process-thread/" class="sidebar-link">002-进程和线程</a></li><li><a href="/browser/003-url-to-display/001-network/" class="active sidebar-link">003-从输入URL到页面加载显示完成到底发生了什么？——网络篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#一-处理请求" class="sidebar-link">一. 处理请求</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#二-构建请求" class="sidebar-link">二. 构建请求</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#三-查找强缓存" class="sidebar-link">三. 查找强缓存</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#四-dns解析" class="sidebar-link">四. DNS解析</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#五-等待-tcp-队列" class="sidebar-link">五. 等待 TCP 队列</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#六-建立tcp连接-进行http请求" class="sidebar-link">六. 建立TCP连接+进行HTTP请求</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#tcp" class="sidebar-link">TCP</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#发送http请求" class="sidebar-link">发送HTTP请求</a></li></ul></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#七-数据的传输过程" class="sidebar-link">七.数据的传输过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#传输层" class="sidebar-link">传输层</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#网络层" class="sidebar-link">网络层</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#数据链路层" class="sidebar-link">数据链路层</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#物理层" class="sidebar-link">物理层</a></li></ul></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#八-响应报文" class="sidebar-link">八.响应报文</a></li><li class="sidebar-sub-header"><a href="/browser/003-url-to-display/001-network/#九-总结" class="sidebar-link">九.总结</a></li></ul></li><li><a href="/browser/003-url-to-display/002-analytical-algorithm/" class="sidebar-link">004-从输入URL到页面加载显示完成到底发生了什么？——解析算法篇</a></li><li><a href="/browser/003-url-to-display/appendix/" class="sidebar-link">基本知识点汇总</a></li><li><a href="/browser/004-pwa/" class="sidebar-link">004-PWA</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS-API揭秘系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搞懂那个TCP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>这个面试不太难</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写JS系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Koa大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDB大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端架构设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端模块化规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自动化测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue-cli的配置详解</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_003-从输入url到页面加载显示完成到底发生了什么？——网络篇"><a href="#_003-从输入url到页面加载显示完成到底发生了什么？——网络篇" aria-hidden="true" class="header-anchor">#</a> 003-从输入URL到页面加载显示完成到底发生了什么？——网络篇</h1> <p><div data-v-21553e4a><p data-v-21553e4a><strong data-v-21553e4a>Hey mate, Please know that</strong></p> <div data-v-21553e4a>坚持比努力更可怕</div> <div class="seperator" data-v-21553e4a></div></div></p> <p>这个题瞅着挺眼熟，看来不深入了解一下是不行了。
那我们就来看看怎么给面试官一个看起来还行的答案。</p> <p><strong>精简版</strong></p> <p>如果，你想混一下，那么给你<code>精简版</code>：</p> <ol><li><p>首先，浏览器根据请求的URL交给DNS域名解析，找到真实的IP，向服务器发起请求；</p></li> <li><p>服务器交给后台处理，在完成后返回数据，浏览器就可以接收HTML、CSS、JavaScript等文件；</p></li> <li><p>浏览器对加载到的HTML、CSS、JavaScript等资源进行语法解析，构建相应的内部数据结构（DOM树、CSS树、render树等）；
载入解析到的资源文件、渲染页面、完成。</p></li></ol> <p><strong>正式版</strong></p> <h2 id="一-处理请求"><a href="#一-处理请求" aria-hidden="true" class="header-anchor">#</a> 一. 处理请求</h2> <p>首先，浏览器会开启一个线程来处理这个请求，浏览器将会分析你输入的内容（<code>协议头</code>、<code>主机域名</code>或<code>IP地址</code>、<code>端口号</code>、<code>请求路径</code>、<code>查询参数</code>、）。</p> <div class="language-html extra-class"><pre class="language-html"><code>//通用的URL由9部分组成
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scheme</span><span class="token punctuation">&gt;</span></span>://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>host</span><span class="token punctuation">&gt;</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>params</span><span class="token punctuation">&gt;</span></span>?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>query</span><span class="token punctuation">&gt;</span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hash</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scheme</span><span class="token punctuation">&gt;</span></span>://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>host</span><span class="token punctuation">&gt;</span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>domain</span><span class="token punctuation">&gt;</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filename</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>部分名词解释：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scheme</span><span class="token punctuation">&gt;</span></span>：对于web页面来说最常用的协议就是http和https
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>：user和password现在不常见，不会在URL明文书写用户名和密码了，都是通过登录的方式
//或者
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>host</span><span class="token punctuation">&gt;</span></span>：定义域主机 。（如http默认的主机是www）
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>domain</span><span class="token punctuation">&gt;</span></span> ： 定义因特网域名。（如http://baidu.com)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">&gt;</span></span>：定义主机上的端口号。端口号用来区分主机上的进程，方便找到web服务器，http默认是80
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>：path是资源的路径，也就是存放位置，不一定和物理路径完全对应，符合web服务器路由约定即可
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>params</span><span class="token punctuation">&gt;</span></span>：在一些协议中需要参数来访问资源，例如 ftp 是二进制还是文本传输，参数是名值对，用;隔开
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>query</span><span class="token punctuation">&gt;</span></span>：这个是get请求最常用的传递参数方式了 ?a=1&amp;b=2&amp;=3
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hash</span><span class="token punctuation">&gt;</span></span>：hash也称为片段，设计为标识文档的一部分，很多MVVM框架用作了路由功能
//或者
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filename</span><span class="token punctuation">&gt;</span></span>: 定义文档和资源的名称
</code></pre></div><p>通常，如果输入的内容里包含了“.com”，浏览器不会认为你输入的是一个搜索关键字。在确定它是一个 URL 之后，浏览器会检查它是否指明了某种协议，如果没有，就会在开头添加“http://”。因为如果你没有指定具体的 HTTP 协议选项，浏览器就会使用默认值，如端口 80、GET 方法、不使用基本的身份验证。</p> <h2 id="二-构建请求"><a href="#二-构建请求" aria-hidden="true" class="header-anchor">#</a> 二. 构建请求</h2> <p>解析完后，然后开启网络线程，浏览器会构建请求行：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 请求方法是GET，路径为根路径，HTTP协议版本为1.1</span>
<span class="token constant">GET</span> <span class="token operator">/</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
</code></pre></div><h2 id="三-查找强缓存"><a href="#三-查找强缓存" aria-hidden="true" class="header-anchor">#</a> 三. 查找强缓存</h2> <p>在真正发起网络请求之前，浏览器会先在浏览器缓存中查询是否有要请求的文件。</p> <p>其中，浏览器缓存是一种在本地保存资源副本，以供下次请求时直接使用的技术。当浏览器发现请求的资源已经在浏览器缓存中存有副本，它会拦截请求，返回该资源的副本，并直接结束请求，而不会再去源服务器重新下载。</p> <p>这样做的好处有：</p> <ul><li><p>缓解服务器端压力，提升性能（获取资源的耗时更短了）；</p></li> <li><p>对于网站来说，缓存是实现快速资源加载的重要组成部分。</p></li></ul> <p>当然，如果缓存查找失败，就会进入下一步。</p> <h2 id="四-dns解析"><a href="#四-dns解析" aria-hidden="true" class="header-anchor">#</a> 四. DNS解析</h2> <p>HTTP 网络请求的第一步是做什么呢？</p> <img src="/assets/img/tcp-http-relationship.7fb84713.png" style="zoom:80%;"> <p>结合上图看，是和服务器建立 TCP 连接。</p> <p>那我们凭借什么信息来建立连接呢？</p> <p>建立 TCP 连接的第一步就是需要准备 IP 地址和端口号。</p> <p>那怎么获取 IP 地址和端口号呢？</p> <p>我们发现，我们只有一个 URL 地址，那么是否可以<strong>利用 URL 地址来获取 IP 和端口信息</strong>呢？</p> <p>一般我们输入的URL是服务器域名，数据包是通过<code>IP地址</code>传给对方的，那我们就需要知道对方的<code>IP地址</code>，这个过程需要依赖一个服务系统，这个系统将域名和 IP 一一映射，我们将这个系统就叫做DNS（Domain Name System域名系统）。得到具体 IP 的过程就是DNS解析。（DNS就像是一个翻译）；</p> <p><strong>解析过程</strong></p> <p>DNS解析是一个递归查询的过程。
<img src="/assets/img/google-dns-search.5bee3e3e.png" alt="图片来自">
上述图片是查找www.google.com的IP地址过程。</p> <p>首先在<code>本地域名服务器</code>中查询IP地址，如果没有找到的情况下，<code>本地域名服务器</code>会向<code>根域名服务器</code>发送一个请求，如果<code>根域名服务器</code>也不存在该域名时，本地域名会向<code>com顶级域名服务器</code>发送一个请求，依次类推下去。直到最后<code>本地域名服务器</code>得到google的IP地址并把它缓存到本地，供下次查询使用。</p> <p>从上述过程中，可以看出网址的解析是一个从右向左的过程: com -&gt; google.com -&gt; www.google.com。但是你是否发现少了点什么，<code>根域名服务器</code>的解析过程呢？事实上，真正的网址是www.google.com.，并不是我多打了一个.，这个.对应的就是<code>根域名服务器</code>，默认情况下所有的网址的最后一位都是.，既然是默认情况下，为了方便用户，通常都会省略，浏览器在请求DNS的时候会自动加上，所有网址真正的解析过程为: . -&gt; .com -&gt; google.com. -&gt; www.google.com.。</p> <p><strong>DNS优化</strong></p> <p>上文中请求到google的IP地址时，经历了8个步骤，这个过程中存在多个请求(同时存在UDP和TCP请求,DNS在区域传输的时候使用TCP协议，其他时候使用UDP协议。)。</p> <p>试想如果每次都经过这么多步骤，那就太耗时间？如何减少该过程的步骤呢？那就是DNS缓存。</p> <p><strong>DNS缓存</strong></p> <p>DNS存在着多级缓存，从离浏览器的距离排序的话，有以下几种:</p> <ul><li>浏览器缓存（注意： 浏览器的缓存一般不会太长，1min左右。假如时间设置过长，会导致DNS在IP变更时不能及时解析获取到最新的IP）</li> <li>系统缓存（如果是第一次访问网站，将会查找系统缓存。）</li> <li>路由器缓存</li> <li>ISP服务器缓存(Internet Service Provider的简称，即因特网服务提供商,咱们一般就是网通或者电信。这时就会到电信（你的服务商）的DNS 上查找缓存)</li></ul> <p><strong>如果以上都没有，开启<code>递归搜索</code>查找IP的过程</strong></p> <ul><li>根域名服务器缓存</li> <li>顶级域名服务器缓存</li> <li>主域名服务器缓存</li></ul> <p><strong>所以，重点来啦，在DNS解析的时候，</strong></p> <ol><li><p>浏览器会先搜索自己的 DNS 缓存（维护一张域名与 IP 地址的对应表）；</p></li> <li><p>搜索操作系统中的 DNS 缓存（维护一张域名与 IP 地址的对应表）；</p></li> <li><p>搜索操作系统的 hosts 文件（ Windows 环境下，维护一张域名与 IP 地址的对应表）；</p></li> <li><p>操作系统将域名发送至 LDNS（本地区域名服务器，如果你在学校接入互联网，则 LDNS 服务器就在学校，如果通过电信接入互联网，则 LDNS 服务器就在你当地的电信那里。）LDNS 查询自己的 DNS 缓存（一般查找成功率在 80% 左右），查找成功则返回结果，失败则发起一个迭代 DNS 解析请求；</p></li> <li><p>LDNS 向 Root Name Server （根域名服务器，其虽然没有每个域名的的具体信息，但存储了负责每个域，如 com、net、org等的解析的顶级域名服务器的地址）发起请求，此处，Root Name Server 返回 com 域的顶级域名服务器的地址；</p></li> <li><p>LDNS 向 com 域的顶级域名服务器发起请求，返回 google.com 域名服务器地址；</p></li> <li><p>LDNS 向 google.com 域名服务器发起请求，得到 www.google.com 的 IP 地址；</p></li> <li><p>LDNS 将得到的 IP 地址返回给操作系统，同时自己也将 IP 地址缓存起来；</p></li> <li><p>操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来；</p></li></ol> <p>那么现在，浏览器已经得到了域名对应的 IP 地址。</p> <p><strong>DNS负载均衡</strong></p> <p>不知道大家有没有思考过一个问题: DNS返回的IP地址是否每次都一样？</p> <p>如果每次都一样是否说明你请求的资源都位于同一台机器上面，那么这台机器需要多高的性能和储存才能满足亿万请求呢？其实真实的互联网世界背后存在成千上百台服务器，大型的网站甚至更多。</p> <p>但是在用户的眼中，它需要的只是处理他的请求，哪台机器处理请求并不重要。</p> <p>DNS可以返回一个合适的机器的IP给用户，例如可以根据每台机器的负载量，该机器离用户地理位置的距离等等，这种过程就是<code>DNS负载均衡</code>，又叫做<code>DNS重定向</code>。</p> <p>大家耳熟能详的<code>CDN(Content Delivery Network)</code>就是利用DNS的重定向技术，DNS服务器会返回一个跟用户最接近的点的IP地址给用户，CDN节点的服务器负责响应用户的请求，提供所需的内容。</p> <h2 id="五-等待-tcp-队列"><a href="#五-等待-tcp-队列" aria-hidden="true" class="header-anchor">#</a> 五. 等待 TCP 队列</h2> <p>通过DNS拿到 IP 之后，接下来就需要获取端口号了。通常情况下，如果 URL 没有特别指明端口号，那么 HTTP 协议默认是 80 端口。</p> <p>Chrome 有个机制，同一个域名同时最多只能建立 6 个 TCP 连接，如果在同一个域名下同时有 10 个请求发生，那么其中 4 个请求会进入排队等待状态，直至进行中的请求完成。当然，如果当前请求数量少于 6，会直接进入下一步，建立 TCP 连接。</p> <p>所以，本步可能不存在。</p> <h2 id="六-建立tcp连接-进行http请求"><a href="#六-建立tcp连接-进行http请求" aria-hidden="true" class="header-anchor">#</a> 六. 建立TCP连接+进行HTTP请求</h2> <blockquote><p>HTTP 请求分为三个部分：TCP 三次握手、HTTP请求、响应信息、关闭 TCP 连接</p></blockquote> <h3 id="tcp"><a href="#tcp" aria-hidden="true" class="header-anchor">#</a> TCP</h3> <p>那么TCP是什么呢？</p> <blockquote><p>TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。</p></blockquote> <p>TCP的可靠主要体现在以下三个方面：</p> <ul><li><p>三次握手确认连接：TCP的三次握手主要是为了确认双方（即客户端和服务端）都拥有接收和发送数据的能力，通过发送3个数据包来建立客户端和服务器之间的连接。</p></li> <li><p>数据包校验，保证数据到达接收方：就是接收方接收到数据包后必须要向发送方确认, 如果发送方没有接到这个确认的消息，就判定为数据包丢失，并重新发送该数据包。当然，发送的过程中还有一个优化策略，就是把大的数据包拆成一个个小包，依次传输到接收方，接收方按照这个小包的顺序把它们组装成完整数据包。</p></li> <li><p>通过四次挥手断开连接：数据传输完成，现在要断开连接了，通过四次挥手来断开连接。</p></li></ul> <p>具体TCP的相关知识，可查看<a href="/network-tcp/001/">搞懂那个TCP</a></p> <h3 id="发送http请求"><a href="#发送http请求" aria-hidden="true" class="header-anchor">#</a> 发送HTTP请求</h3> <p>HTTP的请求报文由<code>请求行（request line）</code>、<code>请求头（header）</code>、<code>请求体</code>三个部分组成。</p> <p><strong>请求行</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 格式：Method Request-URL HTTP-Version CRLF(换行符)</span>
<span class="token comment">// 请求方法是GET，路径为根路径，HTTP协议版本为1.1</span>
<span class="token constant">GET</span> <span class="token operator">/</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
</code></pre></div><p>请求行，包含<code>请求方法</code>、<code>URL</code>、<code>协议版本</code></p> <p>常用的请求方法：GET, POST, PUT, DELETE, OPTIONS, HEAD</p> <p>URL 即请求地址</p> <p>现在常用的协议版本为 HTTP/1.1</p> <p><strong>请求头</strong></p> <p>请求头，包含请求的附加信息，由 关键字/值 对组成，每行一对，用英文冒号分隔。</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">Accept:</span> text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
<span class="token header-name keyword">Accept-Encoding:</span> gzip, deflate, br
<span class="token header-name keyword">Accept-Language:</span> zh-CN,zh;q=0.9
<span class="token header-name keyword">Cache-Control:</span> no-cache
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Cookie:</span> /* 省略cookie信息 */
<span class="token header-name keyword">Host:</span> www.google.com
<span class="token header-name keyword">Pragma:</span> no-cache
<span class="token header-name keyword">Upgrade-Insecure-Requests:</span> 1
<span class="token header-name keyword">User-Agent:</span> Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
</code></pre></div><p>说几个主要的，</p> <p>Host: 表示主机名，虚拟主机；</p> <p>Connection: HTTP/1.1 增加的，使用 keepalive，即持久连接，一个连接可以发多个请求；</p> <p>User-Agent: 请求发出者；</p> <p><strong>请求体(请求正文)</strong></p> <p>请求体在GET方法时不存在，在POST，PUT等方法下存在，常见的场景是表单提交</p> <p>GET产生一个TCP数据包，POST产生两个</p> <p>GET请求时会把headers和data数据一起发送出去；</p> <p>POST请求时，浏览器先发送headers，服务器100继续，浏览器再发送data。</p> <h2 id="七-数据的传输过程"><a href="#七-数据的传输过程" aria-hidden="true" class="header-anchor">#</a> 七.数据的传输过程</h2> <h3 id="传输层"><a href="#传输层" aria-hidden="true" class="header-anchor">#</a> 传输层</h3> <p>寻得服务器地址，客户端在<code>传输层</code>便可以和服务器通过三次握手建立tcpip连接</p> <h3 id="网络层"><a href="#网络层" aria-hidden="true" class="header-anchor">#</a> 网络层</h3> <p>在上边DNS解析的过程中我们已经拿到了IP地址，此时<code>网络层</code>便会通过IP地址寻得对应服务器的物理地址</p> <h3 id="数据链路层"><a href="#数据链路层" aria-hidden="true" class="header-anchor">#</a> 数据链路层</h3> <p>连接建立后<code>数据链路层</code>将数据包装成帧；</p> <h3 id="物理层"><a href="#物理层" aria-hidden="true" class="header-anchor">#</a> 物理层</h3> <p>最后<code>物理层</code>利用物理介质进行传输；</p> <p>到了服务器，就会通过相反的方式将数据一层一层的还原回去；</p> <h2 id="八-响应报文"><a href="#八-响应报文" aria-hidden="true" class="header-anchor">#</a> 八.响应报文</h2> <p>HTTP响应报文也是由三部分组成: <code>响应行</code>, <code>响应报头</code>和<code>响应报文</code>。</p> <p><strong>响应行</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 格式：HTTP-Version Status-Code Status-Code-Description CRLF(换行符)</span>
<span class="token comment">// HTTP协议版本为1.1 状态码是200，状态描述为OK，</span>
<span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> <span class="token constant">OK</span>
</code></pre></div><p>我们可以看到响应行由<code>HTTP协议版本</code>、<code>状态码</code>和<code>状态描述</code>组成。</p> <p>状态码是由3位数组成，第一个数字定义了响应的类别，且有五种可能取值:</p> <ul><li>1xx：指示信息–表示请求已接收，继续处理。</li> <li>2xx：成功–表示请求已被成功接收、理解、接受。</li> <li>3xx：重定向–要完成请求必须进行更进一步的操作。</li> <li>4xx：客户端错误–请求有语法错误或请求无法实现。</li> <li>5xx：服务器端错误–服务器未能实现合法的请求。</li></ul> <p>平时遇到比较常见的状态码有:200, 204, 301, 302, 304, 400, 401, 403, 404, 422, 500。</p> <p><strong>响应报头</strong></p> <p>响应头部包含 <code>响应报文的附加信息</code>，由 属性/值 对组成</p> <p><strong>响应体(响应报文)</strong></p> <p>响应主体包含 <code>回车符</code>、<code>换行符</code>和 <code>响应返回数据</code>，但并不是所有响应报文都有响应数据</p> <h2 id="九-总结"><a href="#九-总结" aria-hidden="true" class="header-anchor">#</a> 九.总结</h2> <p>处理请求-&gt;构建请求-&gt;查找强缓存-&gt;DNS解析-&gt;建立TCP连接-&gt;进行HTTP请求-&gt;得到HTTP响应</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">5/27/2020, 10:57:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/browser/002-process-thread/" class="prev">
          002-进程和线程
        </a></span> <span class="next"><a href="/browser/003-url-to-display/002-analytical-algorithm/">
          004-从输入URL到页面加载显示完成到底发生了什么？——解析算法篇
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.b1906b97.js" defer></script><script src="/assets/js/2.bdee5faf.js" defer></script><script src="/assets/js/10.e085a21c.js" defer></script><script src="/assets/js/7.f0379e88.js" defer></script><script src="/assets/js/8.e132ed9d.js" defer></script>
  </body>
</html>
