<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>001 - MongoDB 基础 | Half Town前端周刊</title>
    <meta name="description" content="白糖炒栗子哒前端Blog">
    <link rel="icon" href="/favicon.ico">
  <link rel="mainfest" href="/mainfest.json">
    
    <link rel="preload" href="/assets/css/0.styles.d4c32f31.css" as="style"><link rel="preload" href="/assets/js/app.b1906b97.js" as="script"><link rel="preload" href="/assets/js/2.bdee5faf.js" as="script"><link rel="preload" href="/assets/js/83.fc10680d.js" as="script"><link rel="preload" href="/assets/js/7.f0379e88.js" as="script"><link rel="preload" href="/assets/js/8.e132ed9d.js" as="script"><link rel="prefetch" href="/assets/js/10.e085a21c.js"><link rel="prefetch" href="/assets/js/100.78a0b04f.js"><link rel="prefetch" href="/assets/js/101.02ef3e98.js"><link rel="prefetch" href="/assets/js/102.cdd542e1.js"><link rel="prefetch" href="/assets/js/103.de748a03.js"><link rel="prefetch" href="/assets/js/104.7455cba5.js"><link rel="prefetch" href="/assets/js/105.68a805c9.js"><link rel="prefetch" href="/assets/js/106.a2ff7e85.js"><link rel="prefetch" href="/assets/js/107.36f34ab6.js"><link rel="prefetch" href="/assets/js/108.f26732f6.js"><link rel="prefetch" href="/assets/js/109.8d05e086.js"><link rel="prefetch" href="/assets/js/11.f2fd41dc.js"><link rel="prefetch" href="/assets/js/110.c7f84bd1.js"><link rel="prefetch" href="/assets/js/111.0cdf0d73.js"><link rel="prefetch" href="/assets/js/12.450e705b.js"><link rel="prefetch" href="/assets/js/13.50973e7a.js"><link rel="prefetch" href="/assets/js/14.40fad099.js"><link rel="prefetch" href="/assets/js/15.a2d432ad.js"><link rel="prefetch" href="/assets/js/16.4ad6c82f.js"><link rel="prefetch" href="/assets/js/17.1bc86885.js"><link rel="prefetch" href="/assets/js/18.ade73665.js"><link rel="prefetch" href="/assets/js/19.a0f47a6e.js"><link rel="prefetch" href="/assets/js/20.5499b902.js"><link rel="prefetch" href="/assets/js/21.86afe090.js"><link rel="prefetch" href="/assets/js/22.29fa6f17.js"><link rel="prefetch" href="/assets/js/23.1af6f734.js"><link rel="prefetch" href="/assets/js/24.933ea1dd.js"><link rel="prefetch" href="/assets/js/25.7b5dc5f0.js"><link rel="prefetch" href="/assets/js/26.03194069.js"><link rel="prefetch" href="/assets/js/27.eb1fac5c.js"><link rel="prefetch" href="/assets/js/28.01df134d.js"><link rel="prefetch" href="/assets/js/29.697d4c02.js"><link rel="prefetch" href="/assets/js/3.77f61fb0.js"><link rel="prefetch" href="/assets/js/30.e1b58026.js"><link rel="prefetch" href="/assets/js/31.41db2b44.js"><link rel="prefetch" href="/assets/js/32.9f2db749.js"><link rel="prefetch" href="/assets/js/33.03b6d68a.js"><link rel="prefetch" href="/assets/js/34.09609909.js"><link rel="prefetch" href="/assets/js/35.c80be0ac.js"><link rel="prefetch" href="/assets/js/36.d15e6050.js"><link rel="prefetch" href="/assets/js/37.1ccd8184.js"><link rel="prefetch" href="/assets/js/38.ab0d4b98.js"><link rel="prefetch" href="/assets/js/39.8301eaad.js"><link rel="prefetch" href="/assets/js/4.90b687b0.js"><link rel="prefetch" href="/assets/js/40.d95907af.js"><link rel="prefetch" href="/assets/js/41.33845e14.js"><link rel="prefetch" href="/assets/js/42.8a256266.js"><link rel="prefetch" href="/assets/js/43.343b309f.js"><link rel="prefetch" href="/assets/js/44.e61b9da2.js"><link rel="prefetch" href="/assets/js/45.0eea8be7.js"><link rel="prefetch" href="/assets/js/46.861203d9.js"><link rel="prefetch" href="/assets/js/47.ae5bd907.js"><link rel="prefetch" href="/assets/js/48.1dbfd265.js"><link rel="prefetch" href="/assets/js/49.87f2ea7e.js"><link rel="prefetch" href="/assets/js/5.06355c1f.js"><link rel="prefetch" href="/assets/js/50.92bcf9cd.js"><link rel="prefetch" href="/assets/js/51.2b54e26b.js"><link rel="prefetch" href="/assets/js/52.ef61db16.js"><link rel="prefetch" href="/assets/js/53.e8411588.js"><link rel="prefetch" href="/assets/js/54.6f0a7cd7.js"><link rel="prefetch" href="/assets/js/55.40d0a721.js"><link rel="prefetch" href="/assets/js/56.76ff8ce6.js"><link rel="prefetch" href="/assets/js/57.cfea78e2.js"><link rel="prefetch" href="/assets/js/58.f8c35f3d.js"><link rel="prefetch" href="/assets/js/59.02cbb18a.js"><link rel="prefetch" href="/assets/js/6.d108277e.js"><link rel="prefetch" href="/assets/js/60.2df7b32b.js"><link rel="prefetch" href="/assets/js/61.16805fc4.js"><link rel="prefetch" href="/assets/js/62.ef5ca102.js"><link rel="prefetch" href="/assets/js/63.923718a5.js"><link rel="prefetch" href="/assets/js/64.d40092dd.js"><link rel="prefetch" href="/assets/js/65.d68a358c.js"><link rel="prefetch" href="/assets/js/66.b4323cbe.js"><link rel="prefetch" href="/assets/js/67.3a9004c1.js"><link rel="prefetch" href="/assets/js/68.350f6fbb.js"><link rel="prefetch" href="/assets/js/69.fdebae43.js"><link rel="prefetch" href="/assets/js/70.ccac64ba.js"><link rel="prefetch" href="/assets/js/71.8948f6c8.js"><link rel="prefetch" href="/assets/js/72.f5d07472.js"><link rel="prefetch" href="/assets/js/73.c2ddba1b.js"><link rel="prefetch" href="/assets/js/74.7a96d852.js"><link rel="prefetch" href="/assets/js/75.d452b4b5.js"><link rel="prefetch" href="/assets/js/76.5eac82cb.js"><link rel="prefetch" href="/assets/js/77.49a8f94c.js"><link rel="prefetch" href="/assets/js/78.17478c01.js"><link rel="prefetch" href="/assets/js/79.545a2920.js"><link rel="prefetch" href="/assets/js/80.172aeb42.js"><link rel="prefetch" href="/assets/js/81.6376c78a.js"><link rel="prefetch" href="/assets/js/82.1dfa8f89.js"><link rel="prefetch" href="/assets/js/84.41df0212.js"><link rel="prefetch" href="/assets/js/85.b57d2894.js"><link rel="prefetch" href="/assets/js/86.1bed09b1.js"><link rel="prefetch" href="/assets/js/87.3bc2e0cf.js"><link rel="prefetch" href="/assets/js/88.5797d5a1.js"><link rel="prefetch" href="/assets/js/89.cfc4d086.js"><link rel="prefetch" href="/assets/js/9.17617c7c.js"><link rel="prefetch" href="/assets/js/90.d3796c5b.js"><link rel="prefetch" href="/assets/js/91.f9e0f122.js"><link rel="prefetch" href="/assets/js/92.8ce6ae6a.js"><link rel="prefetch" href="/assets/js/93.f1c144ce.js"><link rel="prefetch" href="/assets/js/94.1877adf1.js"><link rel="prefetch" href="/assets/js/95.41ce2c18.js"><link rel="prefetch" href="/assets/js/96.07be3e30.js"><link rel="prefetch" href="/assets/js/97.d6ecd209.js"><link rel="prefetch" href="/assets/js/98.b1431a2d.js"><link rel="prefetch" href="/assets/js/99.acea4094.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4c32f31.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Half Town前端周刊</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/posts/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结前端技术文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6-11新特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深入JavaScript系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS-API揭秘系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搞懂那个TCP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>这个面试不太难</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写JS系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Koa大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MongoDB大赏</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mongodb/001-basic/" class="active sidebar-link">001 - MongoDB 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_1-啥是-mongodb？" class="sidebar-link">1. 啥是 MongoDB？</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_2-文档主键-id" class="sidebar-link">2. 文档主键 _id</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_2-1-对象主键-objectid" class="sidebar-link">2.1 对象主键 ObjectId</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-比较操作符" class="sidebar-link">3. 比较操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-1-eq-等于" class="sidebar-link">3.1 &amp;eq 等于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-2-ne-不等于" class="sidebar-link">3.2 &amp;ne 不等于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-3-lt-小于" class="sidebar-link">3.3 &amp;lt 小于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-4-lte-小于等于" class="sidebar-link">3.4 &amp;lte 小于等于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-5-gt-大于" class="sidebar-link">3.5 &amp;gt 大于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-6-gte-大于等于" class="sidebar-link">3.6 &amp;gte 大于等于</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-7-in-在筛选数组里面" class="sidebar-link">3.7 &amp;in 在筛选数组里面</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_3-8-nin-不在筛选数组里面" class="sidebar-link">3.8 &amp;nin 不在筛选数组里面</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_4-逻辑操作符" class="sidebar-link">4. 逻辑操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_4-1-not-不" class="sidebar-link">4.1 $not 不</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_4-2-and-和" class="sidebar-link">4.2 $and 和</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_4-3-or-或" class="sidebar-link">4.3 $or 或</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_4-4-nor-都不" class="sidebar-link">4.4 $nor 都不</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_5-字段操作符" class="sidebar-link">5. 字段操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_5-1-exists" class="sidebar-link">5.1 $exists</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_5-2-type" class="sidebar-link">5.2 $type</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_6-数组操作符" class="sidebar-link">6. 数组操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_6-1-all-数组包含所有查询值" class="sidebar-link">6.1 $all 数组包含所有查询值</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_6-2-elemmatch-数组中有一个满足" class="sidebar-link">6.2 $elemMatch 数组中有一个满足</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-运算操作符" class="sidebar-link">7. 运算操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-1-regex-正则表达式操作符" class="sidebar-link">7.1 $regex 正则表达式操作符</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-2-add" class="sidebar-link">7.2  $add</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-3-subtract" class="sidebar-link">7.3  $subtract</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-4-multiply" class="sidebar-link">7.4  $multiply</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-5-divide" class="sidebar-link">7.5  $divide</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_7-6-mod求余" class="sidebar-link">7.6 $mod求余</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_8-游标" class="sidebar-link">8. 游标</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_9-投影" class="sidebar-link">9. 投影</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#文档投影" class="sidebar-link">文档投影</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#在数组字段上使用投影" class="sidebar-link">在数组字段上使用投影</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-创建-document" class="sidebar-link">10. 创建 Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-1-db-collection-insertone（）创建一个文档" class="sidebar-link">10.1 db.collection.insertOne（）创建一个文档</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-2-db-collection-insertmany-创建多个文档" class="sidebar-link">10.2 db.collection.insertMany() 创建多个文档</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-3-db-collection-insert-创建单个或多个文档" class="sidebar-link">10.3 db.collection.insert() 创建单个或多个文档</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-4-小比较" class="sidebar-link">10.4 小比较</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-5-insertone，insertmany和insert的区别" class="sidebar-link">10.5 insertone，insertMany和insert的区别</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_10-6-db-collection-save-另一个可以用来创建文档的命令" class="sidebar-link">10.6  db.collection.save()另一个可以用来创建文档的命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_11-查询-document" class="sidebar-link">11. 查询 Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_11-1-db-collection-find" class="sidebar-link">11.1 db.collection.find()</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_12-更新-document" class="sidebar-link">12. 更新 Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_12-1-db-collection-update" class="sidebar-link">12.1 db.collection.update()</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_12-2-更新操作符" class="sidebar-link">12.2 更新操作符</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_12-3-数组更新操作符" class="sidebar-link">12.3 数组更新操作符</a></li></ul></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_13-删除文档" class="sidebar-link">13. 删除文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_13-1-db-collection-remove（）" class="sidebar-link">13.1 db.collection.remove（）</a></li><li class="sidebar-sub-header"><a href="/mongodb/001-basic/#_13-2-db-collection-drop（）" class="sidebar-link">13.2 db.collection.drop（）</a></li></ul></li></ul></li><li><a href="/mongodb/002-aggregate/" class="sidebar-link">002 - MongoDB 聚合管道</a></li><li><a href="/mongodb/003-index/" class="sidebar-link">003 - MongoDB 索引</a></li><li><a href="/mongodb/004-data-model/" class="sidebar-link">004 - MongoDB 数据模型</a></li><li><a href="/mongodb/005-replication/" class="sidebar-link">005 - 数据复制</a></li><li><a href="/mongodb/006-sharding/" class="sidebar-link">006 - 数据分片</a></li><li><a href="/mongodb/007-safety/" class="sidebar-link">007 - 数据安全</a></li><li><a href="/mongodb/008-error/" class="sidebar-link">008 - 数据故障</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端架构设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端模块化规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自动化测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue-cli的配置详解</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_001-mongodb-基础"><a href="#_001-mongodb-基础" aria-hidden="true" class="header-anchor">#</a> 001 - MongoDB 基础</h1> <p><div data-v-21553e4a><p data-v-21553e4a><strong data-v-21553e4a>Hey mate, Please know that</strong></p> <div data-v-21553e4a>坚持比努力更可怕</div> <div class="seperator" data-v-21553e4a></div></div></p> <h2 id="_1-啥是-mongodb？"><a href="#_1-啥是-mongodb？" aria-hidden="true" class="header-anchor">#</a> 1. 啥是 MongoDB？</h2> <h2 id="_2-文档主键-id"><a href="#_2-文档主键-id" aria-hidden="true" class="header-anchor">#</a> 2. 文档主键 _id</h2> <ul><li>文档主键的唯一性</li> <li>支持所有数据类型（数组除外）</li></ul> <h3 id="_2-1-对象主键-objectid"><a href="#_2-1-对象主键-objectid" aria-hidden="true" class="header-anchor">#</a> 2.1 对象主键 ObjectId</h3> <ul><li>默认的文档主键</li> <li>可以快速生成的12字节id</li> <li>包含创建时间</li></ul> <h2 id="_3-比较操作符"><a href="#_3-比较操作符" aria-hidden="true" class="header-anchor">#</a> 3. 比较操作符</h2> <h3 id="_3-1-eq-等于"><a href="#_3-1-eq-等于" aria-hidden="true" class="header-anchor">#</a> 3.1 &amp;eq 等于</h3> <h3 id="_3-2-ne-不等于"><a href="#_3-2-ne-不等于" aria-hidden="true" class="header-anchor">#</a> 3.2 &amp;ne 不等于</h3> <h3 id="_3-3-lt-小于"><a href="#_3-3-lt-小于" aria-hidden="true" class="header-anchor">#</a> 3.3 &amp;lt 小于</h3> <h3 id="_3-4-lte-小于等于"><a href="#_3-4-lte-小于等于" aria-hidden="true" class="header-anchor">#</a> 3.4 &amp;lte 小于等于</h3> <h3 id="_3-5-gt-大于"><a href="#_3-5-gt-大于" aria-hidden="true" class="header-anchor">#</a> 3.5 &amp;gt 大于</h3> <h3 id="_3-6-gte-大于等于"><a href="#_3-6-gte-大于等于" aria-hidden="true" class="header-anchor">#</a> 3.6 &amp;gte 大于等于</h3> <h3 id="_3-7-in-在筛选数组里面"><a href="#_3-7-in-在筛选数组里面" aria-hidden="true" class="header-anchor">#</a> 3.7 &amp;in 在筛选数组里面</h3> <p>匹配字段值与任一查询值相等的文档</p> <h3 id="_3-8-nin-不在筛选数组里面"><a href="#_3-8-nin-不在筛选数组里面" aria-hidden="true" class="header-anchor">#</a> 3.8 &amp;nin 不在筛选数组里面</h3> <p>匹配字段值与任何查询值都不等的文档</p> <h2 id="_4-逻辑操作符"><a href="#_4-逻辑操作符" aria-hidden="true" class="header-anchor">#</a> 4. 逻辑操作符</h2> <h3 id="_4-1-not-不"><a href="#_4-1-not-不" aria-hidden="true" class="header-anchor">#</a> 4.1 $not 不</h3> <p>匹配筛选条件不成立的文档</p> <h3 id="_4-2-and-和"><a href="#_4-2-and-和" aria-hidden="true" class="header-anchor">#</a> 4.2 $and 和</h3> <p>匹配多个筛选条件全部成立的文档</p> <h3 id="_4-3-or-或"><a href="#_4-3-or-或" aria-hidden="true" class="header-anchor">#</a> 4.3 $or 或</h3> <p>匹配至少一个筛选条件成立的文档</p> <h3 id="_4-4-nor-都不"><a href="#_4-4-nor-都不" aria-hidden="true" class="header-anchor">#</a> 4.4 $nor 都不</h3> <p>匹配多个筛选条件全部不成立的文档</p> <h2 id="_5-字段操作符"><a href="#_5-字段操作符" aria-hidden="true" class="header-anchor">#</a> 5. 字段操作符</h2> <h3 id="_5-1-exists"><a href="#_5-1-exists" aria-hidden="true" class="header-anchor">#</a> 5.1 $exists</h3> <p>匹配包含查询字段的文档</p> <h3 id="_5-2-type"><a href="#_5-2-type" aria-hidden="true" class="header-anchor">#</a> 5.2 $type</h3> <p>匹配字段类型符合查询值的文档</p> <h2 id="_6-数组操作符"><a href="#_6-数组操作符" aria-hidden="true" class="header-anchor">#</a> 6. 数组操作符</h2> <h3 id="_6-1-all-数组包含所有查询值"><a href="#_6-1-all-数组包含所有查询值" aria-hidden="true" class="header-anchor">#</a> 6.1 $all 数组包含所有查询值</h3> <p>匹配数组字段中包含所有查询值的文档</p> <h3 id="_6-2-elemmatch-数组中有一个满足"><a href="#_6-2-elemmatch-数组中有一个满足" aria-hidden="true" class="header-anchor">#</a> 6.2 $elemMatch 数组中有一个满足</h3> <p>匹配数组字段中至少存在一个值满足筛选条件的文档</p> <h2 id="_7-运算操作符"><a href="#_7-运算操作符" aria-hidden="true" class="header-anchor">#</a> 7. 运算操作符</h2> <h3 id="_7-1-regex-正则表达式操作符"><a href="#_7-1-regex-正则表达式操作符" aria-hidden="true" class="header-anchor">#</a> 7.1 $regex 正则表达式操作符</h3> <p>{<field>:{:/pattern/, :'<options>'}}
{<field>:{:/pattern/<options>}}</options></field></options></field></p> <h3 id="_7-2-add"><a href="#_7-2-add" aria-hidden="true" class="header-anchor">#</a> 7.2  $add</h3> <h3 id="_7-3-subtract"><a href="#_7-3-subtract" aria-hidden="true" class="header-anchor">#</a> 7.3  $subtract</h3> <h3 id="_7-4-multiply"><a href="#_7-4-multiply" aria-hidden="true" class="header-anchor">#</a> 7.4  $multiply</h3> <h3 id="_7-5-divide"><a href="#_7-5-divide" aria-hidden="true" class="header-anchor">#</a> 7.5  $divide</h3> <h3 id="_7-6-mod求余"><a href="#_7-6-mod求余" aria-hidden="true" class="header-anchor">#</a> 7.6 $mod求余</h3> <h2 id="_8-游标"><a href="#_8-游标" aria-hidden="true" class="header-anchor">#</a> 8. 游标</h2> <p>游历完游标中所有的文档之后，或者在10分钟之后，游标便会自动关闭可以使用 noCursorTimeout() 函数来保持游标一直有效。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myCursor <span class="token operator">=</span> db<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noCursorTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 在这之后， 在不遍历游标的情况下， 你需要主动关闭游标</span>
myCursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_8-1-cursor-hasnext"><a href="#_8-1-cursor-hasnext" aria-hidden="true" class="header-anchor">#</a> 8.1 cursor.hasNext()</h4> <h4 id="_8-2-cursor-next"><a href="#_8-2-cursor-next" aria-hidden="true" class="header-anchor">#</a> 8.2 cursor.next()</h4> <h4 id="_8-3-cursor-foreach"><a href="#_8-3-cursor-foreach" aria-hidden="true" class="header-anchor">#</a> 8.3 cursor.forEach()</h4> <h4 id="_8-4-cursor-limit"><a href="#_8-4-cursor-limit" aria-hidden="true" class="header-anchor">#</a> 8.4 cursor.limit()</h4> <h4 id="_8-5-cursor-skip"><a href="#_8-5-cursor-skip" aria-hidden="true" class="header-anchor">#</a> 8.5 cursor.skip()</h4> <h4 id="_8-6-cursor-count"><a href="#_8-6-cursor-count" aria-hidden="true" class="header-anchor">#</a> 8.6 cursor.count()</h4> <p>cursor.count(<applySkipLimit>)</applySkipLimit></p> <p>默认情况下，<applySkipLimit> 为 false，即 cursor.count()不会考虑cursor.skip()和cursor.limit()的效果</applySkipLimit></p> <p>在不提供筛选条件时，cursor.count() 会从集合的元数据Metadata中取得结果</p> <p>当数据库分布式结构较为复杂时，元数据中的文档数量可能不准确。</p> <p>在这种情况下，应该避免应用不提供筛选条件的 cursor.count() 函数，而使用聚合管道来计算文档数量</p> <h4 id="_8-7-cursor-sort"><a href="#_8-7-cursor-sort" aria-hidden="true" class="header-anchor">#</a> 8.7 cursor.sort()</h4> <p>cursor.sort(<document>)</document></p> <p>这里的 <document> 定义了排序的要求</document></p> <p>{field:ordering}</p> <p>1表示由小及大的正向排序，-1表示逆向排序</p> <h4 id="综合使用游标函数时的问题"><a href="#综合使用游标函数时的问题" aria-hidden="true" class="header-anchor">#</a> 综合使用游标函数时的问题</h4> <p>cursor.skip（），cursor.limit（），cursor.sort（）</p> <p>cursor.skip（）在cursor.1imit（）之前执行</p> <p>cursor.sort（）在cursor.skip（）和cursor.limit（）之前执行</p> <p>当结合在一起使用时，游标函数的应用顺序是sort（），skip（），limit（）</p> <h2 id="_9-投影"><a href="#_9-投影" aria-hidden="true" class="header-anchor">#</a> 9. 投影</h2> <h3 id="文档投影"><a href="#文档投影" aria-hidden="true" class="header-anchor">#</a> 文档投影</h3> <p>db.collection.find（<query>，<projection>）</projection></query></p> <p>不使用投影时，db.collection.find（）返回符合筛选条件的完整文档而使用投影可以有选择性的返回文档中的部分字段</p> <p>{field:inclusion}</p> <p>1表示返回字段，0表示不返回字段</p> <h3 id="在数组字段上使用投影"><a href="#在数组字段上使用投影" aria-hidden="true" class="header-anchor">#</a> 在数组字段上使用投影</h3> <h4 id="slide"><a href="#slide" aria-hidden="true" class="header-anchor">#</a> $slide</h4> <p>$slide操作符可以返回数组字段中的部分元素</p> <p>$slide()</p> <p>$elemMatch和$操作符可以返回数组字段中满足筛选条件的第一个元素</p> <h2 id="_10-创建-document"><a href="#_10-创建-document" aria-hidden="true" class="header-anchor">#</a> 10. 创建 Document</h2> <h3 id="_10-1-db-collection-insertone（）创建一个文档"><a href="#_10-1-db-collection-insertone（）创建一个文档" aria-hidden="true" class="header-anchor">#</a> 10.1 db.collection.insertOne（）创建一个文档</h3> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span> <span class="token operator">&lt;</span> collection <span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span> <span class="token operator">&lt;</span>
    document <span class="token operator">&gt;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>
        writeConcern<span class="token punctuation">:</span> <span class="token operator">&lt;</span> document <span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">// 这里的&lt;collection&gt;要替换成文档将要写入的集合</span>
<span class="token comment">// 这里的&lt;document&gt;要替换成将要写入的文档本身</span>
</code></pre></div><p>这里的writeconcern文档定义了本次文档创建操作的安全写级别。</p> <p>简单来说，安全写级别用来判断一次数据库写入操作是否成功安全写级别越高，丢失数据的风险就越低。</p> <p>然而写入操作的延迟也可能更高如果不提供writeconcern文档，mongopB使用默认的安全写级别。</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 返回的结果</span>
<span class="token comment">// {&quot;acknowledged&quot;:true，&quot;insertedrd&quot;:&quot;account1&quot;}</span>

<span class="token comment">// &quot;acknowledged&quot;:true表示安全写级别被启用由于我们在db.collection.insertone（）命令中并没有提供writeconcern文档，这里显示的是 mongoDB 默认的安全写级别启用状态</span>

<span class="token comment">// &quot;insertedId“显示了被写入的文档的 _id</span>
</code></pre></div><p>如果db.collection.insertOne() 遇到了错误 ...，使用重复的 <code>_id</code> 创建一个新文档会造成错误，可以使用 <code>try{} catch(e){print(e)}</code> 来捕捉错误并打印出错误信息。</p> <p>如果需要 MongoDB 自动生成 _id，省略创建文档中的 _id 字段即可。</p> <h3 id="_10-2-db-collection-insertmany-创建多个文档"><a href="#_10-2-db-collection-insertmany-创建多个文档" aria-hidden="true" class="header-anchor">#</a> 10.2 db.collection.insertMany() 创建多个文档</h3> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span> <span class="token operator">&lt;</span> collection <span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span> <span class="token operator">&lt;</span> document1 <span class="token operator">&gt;</span> ， <span class="token operator">&lt;</span> document2 <span class="token operator">&gt;</span> ，<span class="token operator">...</span><span class="token punctuation">]</span>， <span class="token punctuation">{</span>
        writeConcern<span class="token punctuation">:</span> <span class="token operator">&lt;</span> document <span class="token operator">&gt;</span> ，
            ordered<span class="token punctuation">:</span> <span class="token operator">&lt;</span> boolean <span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">// ordered参数用来决定mongoDB是否要按顺序来写入这些文档</span>
<span class="token comment">// 如果将ordered参数设置为false，mongopB可以打乱文档写入的顺序，以便优化写入操作的性能</span>
<span class="token comment">// ordered参数的默认值为true</span>
</code></pre></div><p>如果 db.collection.insertMany() 遇到了错误 ...</p> <h4 id="在顺序写入时遇到错误"><a href="#在顺序写入时遇到错误" aria-hidden="true" class="header-anchor">#</a> 在顺序写入时遇到错误</h4> <p>在顺序写入时，一旦遇到错误，操作便会退出，剩余的文档无论正确与否，都不会被写入。</p> <p>即，如果是第一个插入便遇到错误则后面的文档均不会被插入。</p> <p>如果是中间的文档插入出现错误，则不影响前面的文档的成功插入。</p> <h4 id="在乱序写入时遇到错误"><a href="#在乱序写入时遇到错误" aria-hidden="true" class="header-anchor">#</a> 在乱序写入时遇到错误</h4> <p>在乱序写入时，即使某些文档造成了错误，剩余的正确文档仍然会被写入</p> <h3 id="_10-3-db-collection-insert-创建单个或多个文档"><a href="#_10-3-db-collection-insert-创建单个或多个文档" aria-hidden="true" class="header-anchor">#</a> 10.3 db.collection.insert() 创建单个或多个文档</h3> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span> <span class="token operator">&lt;</span> collection <span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> <span class="token operator">&lt;</span>
    document or array <span class="token keyword">of</span> documents <span class="token operator">&gt;</span> ，<span class="token punctuation">{</span>
        writeConcern<span class="token punctuation">:</span> <span class="token operator">&lt;</span> document <span class="token operator">&gt;</span> ，
            ordered<span class="token punctuation">:</span> <span class="token operator">&lt;</span> boolean <span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// db.collection.insert（）既可以写入一个单独的文档，也可以写入多个文档</span>
</code></pre></div><h3 id="_10-4-小比较"><a href="#_10-4-小比较" aria-hidden="true" class="header-anchor">#</a> 10.4 小比较</h3> <p>三个命令返回的结果文档格式不一样</p> <p>insertone返回的正确结果文档:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;acknowledged&quot;</span><span class="token punctuation">:</span>
<span class="token boolean">true</span>，
    <span class="token string">&quot;insertedId&quot;</span><span class="token punctuation">:</span>
    ObjectId（ <span class="token string">&quot;56fc40f9d735c28df206d078&quot;</span>）
</code></pre></div><p>insertone返回的错误结果文档:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">WriteError</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;index&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span>， <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">11000</span>， <span class="token string">&quot;errmsg &quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E11000 duplicate key error collection: test.accounts index: _id dup key: {: &quot;</span>
    account1 &quot;
<span class="token punctuation">}</span>
&quot;，
<span class="token string">&quot;op&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;account1&quot;</span>，
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;alice&quot;</span>，
    <span class="token string">&quot;balance&quot;</span><span class="token punctuation">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>insertMany返回的正确结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;acknowledged&quot;</span>：
    <span class="token boolean">true</span>，
        <span class="token string">&quot;insertedIds&quot;</span>： <span class="token punctuation">[</span>
            QbjectId（ <span class="token string">&quot;562a94d381cb9f1cd6eb0ela&quot;</span>），
            objectId（ <span class="token string">&quot;562a94d381cb9f1cd6eb0e1b&quot;</span>），
            ObjectId（ <span class="token string">&quot;562a94d381cb9f1cd6eb0elc&quot;</span>）
        <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>insertMany返回的错误结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">BulkWriteError</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;writeErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token string">&quot;index&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">11000</span><span class="token punctuation">,</span>
            <span class="token string">&quot;errmsg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { _id: \&quot;account1\&quot; }&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;op&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;_id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;account1&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;chy&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;writeConcernErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nInserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nUpserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nMatched&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nModified&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nRemoved&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;upserted&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token function">BulkWriteError</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;writeErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token string">&quot;index&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">11000</span><span class="token punctuation">,</span>
            <span class="token string">&quot;errmsg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { _id: \&quot;account1\&quot; }&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;op&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;_id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;account1&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;chy&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;writeConcernErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nInserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nUpserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nMatched&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nModified&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;nRemoved&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;upserted&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>insert写入单个文档返回的正确结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;nInserted&quot;</span>：
    <span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>insert写入单个文档返回的错误结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;nInserted&quot;</span>：
    <span class="token number">0</span>， <span class="token string">&quot;writeError&quot;</span>： <span class="token punctuation">{</span>
        <span class="token string">&quot;code&quot;</span>：
        <span class="token number">11000</span>，
            <span class="token string">&quot;errmsg&quot;</span>：
        <span class="token string">&quot;insertDocument:：caused by:：11000 E11000 duplicate k ey error index:test.foo.dup key:{：1.0}&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>insert写入多个文档返回的正确结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">BulkWriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;writeErrors&quot;</span>： <span class="token punctuation">[</span><span class="token punctuation">]</span>，
    <span class="token string">&quot;writeConcernErrors&quot;</span>： <span class="token punctuation">[</span><span class="token punctuation">]</span>，
    <span class="token string">&quot;nInserted&quot;</span>：
    <span class="token number">2</span>， <span class="token string">&quot;nUpserted&quot;</span>：
    <span class="token number">0</span>， <span class="token string">&quot;nMatched&quot;</span>：
    <span class="token number">0</span>， <span class="token string">&quot;nModified&quot;</span>：
    <span class="token number">0</span>， <span class="token string">&quot;nRemoved&quot;</span>：
    <span class="token number">0</span>，“ upserted &quot;：<span class="token punctuation">[</span><span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>insert写入多个文档返回的错误结果文档：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Bu1kWriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;writeErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token number">125542181</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">11000</span><span class="token punctuation">,</span>
            <span class="token string">&quot;errmsg&quot;</span><span class="token punctuation">:</span> &quot;<span class="token constant">E11000</span> duplicate key error collection<span class="token punctuation">:</span> test<span class="token punctuation">.</span>accounts index<span class="token punctuation">:</span> _id_dup key<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">:</span> account1
        <span class="token punctuation">}</span>
        &quot;<span class="token punctuation">,</span>
        <span class="token string">&quot;op&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;account1&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;alice&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;balance&quot;</span><span class="token punctuation">:</span> <span class="token number">100</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">&quot;writeConcernErrors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">&quot;nInserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token string">&quot;nUpserted&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token string">&quot;nMatched&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token string">&quot;nModified&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token string">&quot;nRemoved&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token string">&quot;upserted&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_10-5-insertone，insertmany和insert的区别"><a href="#_10-5-insertone，insertmany和insert的区别" aria-hidden="true" class="header-anchor">#</a> 10.5 insertone，insertMany和insert的区别</h3> <p>insertone 和 insertMany 命令不支持 db.collection.explain() 命令</p> <p>insert 支持 db.collection.explain() 命令</p> <h3 id="_10-6-db-collection-save-另一个可以用来创建文档的命令"><a href="#_10-6-db-collection-save-另一个可以用来创建文档的命令" aria-hidden="true" class="header-anchor">#</a> 10.6  db.collection.save()另一个可以用来创建文档的命令</h3> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span> <span class="token operator">&lt;</span> collection <span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span> <span class="token operator">&lt;</span>
    document <span class="token operator">&gt;</span> ，<span class="token punctuation">{</span>
        writeConcern： <span class="token operator">&lt;</span> document <span class="token operator">&gt;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当db.collection.save（）命令处理一个新文档的时候，它会调用db.collection.insert（）命令</p> <h2 id="_11-查询-document"><a href="#_11-查询-document" aria-hidden="true" class="header-anchor">#</a> 11. 查询 Document</h2> <h3 id="_11-1-db-collection-find"><a href="#_11-1-db-collection-find" aria-hidden="true" class="header-anchor">#</a> 11.1 db.collection.find()</h3> <h2 id="_12-更新-document"><a href="#_12-更新-document" aria-hidden="true" class="header-anchor">#</a> 12. 更新 Document</h2> <h3 id="_12-1-db-collection-update"><a href="#_12-1-db-collection-update" aria-hidden="true" class="header-anchor">#</a> 12.1 db.collection.update()</h3> <p>db.<collection>.update(<query>, <update>, <options>)</options></update></query></collection></p> <h3 id="_12-2-更新操作符"><a href="#_12-2-更新操作符" aria-hidden="true" class="header-anchor">#</a> 12.2 更新操作符</h3> <h4 id="set更新或新增字段"><a href="#set更新或新增字段" aria-hidden="true" class="header-anchor">#</a> $ set更新或新增字段</h4> <h4 id="unset-删除字段"><a href="#unset-删除字段" aria-hidden="true" class="header-anchor">#</a> $ unset 删除字段</h4> <h4 id="rename-重命名字段"><a href="#rename-重命名字段" aria-hidden="true" class="header-anchor">#</a> $ rename 重命名字段</h4> <h4 id="inc-加减字段值"><a href="#inc-加减字段值" aria-hidden="true" class="header-anchor">#</a> $ inc 加减字段值</h4> <h4 id="mul相乘字段值"><a href="#mul相乘字段值" aria-hidden="true" class="header-anchor">#</a> $ mul相乘字段值</h4> <h4 id="min-比较减小字段值"><a href="#min-比较减小字段值" aria-hidden="true" class="header-anchor">#</a> $ min 比较减小字段值</h4> <h4 id="max比较增大字段值"><a href="#max比较增大字段值" aria-hidden="true" class="header-anchor">#</a> $ max比较增大字段值</h4> <p>如果被更新的字段类型和更新值类型不一致，$min 和 $max 命令会按照 BSON 数据类型排序规则进行比较</p> <div class="language-js extra-class"><pre class="language-js"><code>最小 Nul1
Numbers（ ints， longs， doubles， decimals）
Symbol
String
Object
Array
BinData
ObjectId
Boolean
Date
Timestamp
最大 Regular Expression
</code></pre></div><h3 id="_12-3-数组更新操作符"><a href="#_12-3-数组更新操作符" aria-hidden="true" class="header-anchor">#</a> 12.3 数组更新操作符</h3> <h4 id="addtoset-向数组中增添元素"><a href="#addtoset-向数组中增添元素" aria-hidden="true" class="header-anchor">#</a> $addToSet 向数组中增添元素</h4> <h4 id="pop-从数组中移除元素"><a href="#pop-从数组中移除元素" aria-hidden="true" class="header-anchor">#</a> $pop 从数组中移除元素</h4> <h4 id="pull-从数组中有选择性地移除元素"><a href="#pull-从数组中有选择性地移除元素" aria-hidden="true" class="header-anchor">#</a> $pull 从数组中有选择性地移除元素</h4> <h4 id="pullall-从数组中有选择性地移除元素"><a href="#pullall-从数组中有选择性地移除元素" aria-hidden="true" class="header-anchor">#</a> $pullAll 从数组中有选择性地移除元素</h4> <h4 id="push-向数组中增添元素"><a href="#push-向数组中增添元素" aria-hidden="true" class="header-anchor">#</a> $push 向数组中增添元素</h4> <h2 id="_13-删除文档"><a href="#_13-删除文档" aria-hidden="true" class="header-anchor">#</a> 13. 删除文档</h2> <h3 id="_13-1-db-collection-remove（）"><a href="#_13-1-db-collection-remove（）" aria-hidden="true" class="header-anchor">#</a> 13.1 db.collection.remove（）</h3> <p>db.<collection>.remove（<query>，<options>）sse1s1</options></query></collection></p> <p><query>文档定义了删除操作时筛选文档的条件这里的<query>文档与 db.collection.find() 中的<query>文档是相同的</query></query></query></p> <p>在默认情况下，remove命令会删除所有符合筛选条件的文档</p> <p>如果只想删除满足筛选条件的<em>第一篇</em>文档，可以将 justOne 选项设置为 true</p> <h3 id="_13-2-db-collection-drop（）"><a href="#_13-2-db-collection-drop（）" aria-hidden="true" class="header-anchor">#</a> 13.2 db.collection.drop（）</h3> <p>db.<collection>.drop（{writeconcern:<document>}）</document></collection></p> <p>这里的writeconcern文档定义了本次集合删除操作的安全写级别</p> <p>之前的remove命令可以删除集合内的所有文档，但是不会删除集合</p> <blockquote><p>如果集合中的文档数量很多，使用remove命令删除所有文档的效率不高这种情况下，
更加有效率的方法，是使用drop命令删除集合，然后再创建空集合并创建索引</p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">6/10/2020, 4:44:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/koa/006-koa-reflect-metadata/" class="prev">
          006 - Reflect Metadata 简单入门
        </a></span> <span class="next"><a href="/mongodb/002-aggregate/">
          002 - MongoDB 聚合管道
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.b1906b97.js" defer></script><script src="/assets/js/2.bdee5faf.js" defer></script><script src="/assets/js/83.fc10680d.js" defer></script><script src="/assets/js/7.f0379e88.js" defer></script><script src="/assets/js/8.e132ed9d.js" defer></script>
  </body>
</html>
