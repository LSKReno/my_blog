<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>005: 这个cookie不太难 | Half Town前端周刊</title>
    <meta name="description" content="白糖炒栗子哒前端Blog">
    <link rel="icon" href="/favicon.ico">
  <link rel="mainfest" href="/mainfest.json">
    
    <link rel="preload" href="/assets/css/0.styles.d4c32f31.css" as="style"><link rel="preload" href="/assets/js/app.b1906b97.js" as="script"><link rel="preload" href="/assets/js/2.bdee5faf.js" as="script"><link rel="preload" href="/assets/js/12.450e705b.js" as="script"><link rel="preload" href="/assets/js/7.f0379e88.js" as="script"><link rel="preload" href="/assets/js/8.e132ed9d.js" as="script"><link rel="prefetch" href="/assets/js/10.e085a21c.js"><link rel="prefetch" href="/assets/js/100.78a0b04f.js"><link rel="prefetch" href="/assets/js/101.02ef3e98.js"><link rel="prefetch" href="/assets/js/102.cdd542e1.js"><link rel="prefetch" href="/assets/js/103.de748a03.js"><link rel="prefetch" href="/assets/js/104.7455cba5.js"><link rel="prefetch" href="/assets/js/105.68a805c9.js"><link rel="prefetch" href="/assets/js/106.a2ff7e85.js"><link rel="prefetch" href="/assets/js/107.36f34ab6.js"><link rel="prefetch" href="/assets/js/108.f26732f6.js"><link rel="prefetch" href="/assets/js/109.8d05e086.js"><link rel="prefetch" href="/assets/js/11.f2fd41dc.js"><link rel="prefetch" href="/assets/js/110.c7f84bd1.js"><link rel="prefetch" href="/assets/js/111.0cdf0d73.js"><link rel="prefetch" href="/assets/js/13.50973e7a.js"><link rel="prefetch" href="/assets/js/14.40fad099.js"><link rel="prefetch" href="/assets/js/15.a2d432ad.js"><link rel="prefetch" href="/assets/js/16.4ad6c82f.js"><link rel="prefetch" href="/assets/js/17.1bc86885.js"><link rel="prefetch" href="/assets/js/18.ade73665.js"><link rel="prefetch" href="/assets/js/19.a0f47a6e.js"><link rel="prefetch" href="/assets/js/20.5499b902.js"><link rel="prefetch" href="/assets/js/21.86afe090.js"><link rel="prefetch" href="/assets/js/22.29fa6f17.js"><link rel="prefetch" href="/assets/js/23.1af6f734.js"><link rel="prefetch" href="/assets/js/24.933ea1dd.js"><link rel="prefetch" href="/assets/js/25.7b5dc5f0.js"><link rel="prefetch" href="/assets/js/26.03194069.js"><link rel="prefetch" href="/assets/js/27.eb1fac5c.js"><link rel="prefetch" href="/assets/js/28.01df134d.js"><link rel="prefetch" href="/assets/js/29.697d4c02.js"><link rel="prefetch" href="/assets/js/3.77f61fb0.js"><link rel="prefetch" href="/assets/js/30.e1b58026.js"><link rel="prefetch" href="/assets/js/31.41db2b44.js"><link rel="prefetch" href="/assets/js/32.9f2db749.js"><link rel="prefetch" href="/assets/js/33.03b6d68a.js"><link rel="prefetch" href="/assets/js/34.09609909.js"><link rel="prefetch" href="/assets/js/35.c80be0ac.js"><link rel="prefetch" href="/assets/js/36.d15e6050.js"><link rel="prefetch" href="/assets/js/37.1ccd8184.js"><link rel="prefetch" href="/assets/js/38.ab0d4b98.js"><link rel="prefetch" href="/assets/js/39.8301eaad.js"><link rel="prefetch" href="/assets/js/4.90b687b0.js"><link rel="prefetch" href="/assets/js/40.d95907af.js"><link rel="prefetch" href="/assets/js/41.33845e14.js"><link rel="prefetch" href="/assets/js/42.8a256266.js"><link rel="prefetch" href="/assets/js/43.343b309f.js"><link rel="prefetch" href="/assets/js/44.e61b9da2.js"><link rel="prefetch" href="/assets/js/45.0eea8be7.js"><link rel="prefetch" href="/assets/js/46.861203d9.js"><link rel="prefetch" href="/assets/js/47.ae5bd907.js"><link rel="prefetch" href="/assets/js/48.1dbfd265.js"><link rel="prefetch" href="/assets/js/49.87f2ea7e.js"><link rel="prefetch" href="/assets/js/5.06355c1f.js"><link rel="prefetch" href="/assets/js/50.92bcf9cd.js"><link rel="prefetch" href="/assets/js/51.2b54e26b.js"><link rel="prefetch" href="/assets/js/52.ef61db16.js"><link rel="prefetch" href="/assets/js/53.e8411588.js"><link rel="prefetch" href="/assets/js/54.6f0a7cd7.js"><link rel="prefetch" href="/assets/js/55.40d0a721.js"><link rel="prefetch" href="/assets/js/56.76ff8ce6.js"><link rel="prefetch" href="/assets/js/57.cfea78e2.js"><link rel="prefetch" href="/assets/js/58.f8c35f3d.js"><link rel="prefetch" href="/assets/js/59.02cbb18a.js"><link rel="prefetch" href="/assets/js/6.d108277e.js"><link rel="prefetch" href="/assets/js/60.2df7b32b.js"><link rel="prefetch" href="/assets/js/61.16805fc4.js"><link rel="prefetch" href="/assets/js/62.ef5ca102.js"><link rel="prefetch" href="/assets/js/63.923718a5.js"><link rel="prefetch" href="/assets/js/64.d40092dd.js"><link rel="prefetch" href="/assets/js/65.d68a358c.js"><link rel="prefetch" href="/assets/js/66.b4323cbe.js"><link rel="prefetch" href="/assets/js/67.3a9004c1.js"><link rel="prefetch" href="/assets/js/68.350f6fbb.js"><link rel="prefetch" href="/assets/js/69.fdebae43.js"><link rel="prefetch" href="/assets/js/70.ccac64ba.js"><link rel="prefetch" href="/assets/js/71.8948f6c8.js"><link rel="prefetch" href="/assets/js/72.f5d07472.js"><link rel="prefetch" href="/assets/js/73.c2ddba1b.js"><link rel="prefetch" href="/assets/js/74.7a96d852.js"><link rel="prefetch" href="/assets/js/75.d452b4b5.js"><link rel="prefetch" href="/assets/js/76.5eac82cb.js"><link rel="prefetch" href="/assets/js/77.49a8f94c.js"><link rel="prefetch" href="/assets/js/78.17478c01.js"><link rel="prefetch" href="/assets/js/79.545a2920.js"><link rel="prefetch" href="/assets/js/80.172aeb42.js"><link rel="prefetch" href="/assets/js/81.6376c78a.js"><link rel="prefetch" href="/assets/js/82.1dfa8f89.js"><link rel="prefetch" href="/assets/js/83.fc10680d.js"><link rel="prefetch" href="/assets/js/84.41df0212.js"><link rel="prefetch" href="/assets/js/85.b57d2894.js"><link rel="prefetch" href="/assets/js/86.1bed09b1.js"><link rel="prefetch" href="/assets/js/87.3bc2e0cf.js"><link rel="prefetch" href="/assets/js/88.5797d5a1.js"><link rel="prefetch" href="/assets/js/89.cfc4d086.js"><link rel="prefetch" href="/assets/js/9.17617c7c.js"><link rel="prefetch" href="/assets/js/90.d3796c5b.js"><link rel="prefetch" href="/assets/js/91.f9e0f122.js"><link rel="prefetch" href="/assets/js/92.8ce6ae6a.js"><link rel="prefetch" href="/assets/js/93.f1c144ce.js"><link rel="prefetch" href="/assets/js/94.1877adf1.js"><link rel="prefetch" href="/assets/js/95.41ce2c18.js"><link rel="prefetch" href="/assets/js/96.07be3e30.js"><link rel="prefetch" href="/assets/js/97.d6ecd209.js"><link rel="prefetch" href="/assets/js/98.b1431a2d.js"><link rel="prefetch" href="/assets/js/99.acea4094.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4c32f31.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Half Town前端周刊</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/posts/" class="nav-link">目录</a></div><div class="nav-item"><a href="https://github.com/LSKReno" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://weibo.com/u/5092674629" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://lskreno.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LSKReno的 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/posts/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结前端技术文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6-11新特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深入JavaScript系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS-API揭秘系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搞懂那个TCP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>这个面试不太难</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/001-eventloop/" class="sidebar-link">001: 说说事件循环机制(JS的执行机制)</a></li><li><a href="/interview/002-closure/" class="sidebar-link">002: 闭包</a></li><li><a href="/interview/003-cross-orign/" class="sidebar-link">003:前端跨域问题</a></li><li><a href="/interview/004-js-7-inherits/" class="sidebar-link">004:JavaScript七大继承完爆面试</a></li><li><a href="/interview/005-cookie/" class="active sidebar-link">005: 这个cookie不太难</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/005-cookie/#什么是cookie" class="sidebar-link">什么是cookie</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie长什么样子" class="sidebar-link">cookie长什么样子</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie怎么设置" class="sidebar-link">cookie怎么设置</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie在请求流程中的-角色" class="sidebar-link">cookie在请求流程中的'角色'</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie不可跨域" class="sidebar-link">cookie不可跨域</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie的属性" class="sidebar-link">cookie的属性</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#chrome80默认samesite" class="sidebar-link">Chrome80默认SameSite</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/005-cookie/#跨域和跨站" class="sidebar-link">跨域和跨站</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#如何修改删除cookie" class="sidebar-link">如何修改删除cookie</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie的用处" class="sidebar-link">cookie的用处</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie的缺点" class="sidebar-link">cookie的缺点</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#cookie的防篡改" class="sidebar-link">cookie的防篡改</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/005-cookie/#为什么cookie需要防篡改" class="sidebar-link">为什么Cookie需要防篡改</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#防篡改签名" class="sidebar-link">防篡改签名</a></li><li class="sidebar-sub-header"><a href="/interview/005-cookie/#敏感数据的保护" class="sidebar-link">敏感数据的保护</a></li></ul></li></ul></li><li><a href="/interview/006-garbage-collection/" class="sidebar-link">006:JS的垃圾回收机制</a></li><li><a href="/interview/007-regexp/" class="sidebar-link">007:正则表达式</a></li><li><a href="/interview/008-0.3=0.1+0.2/" class="sidebar-link">008:从判断 0.1 + 0.2 与 0.3 是否相等引发出的知识</a></li><li><a href="/interview/009-eventmodel/" class="sidebar-link">JavaScript事件模型</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写JS系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Koa大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDB大赏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端架构设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端模块化规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自动化测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue-cli的配置详解</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_005-这个cookie不太难"><a href="#_005-这个cookie不太难" aria-hidden="true" class="header-anchor">#</a> 005: 这个cookie不太难</h1> <p><div data-v-21553e4a><p data-v-21553e4a><strong data-v-21553e4a>Hey mate, Please know that</strong></p> <div data-v-21553e4a>坚持比努力更可怕</div> <div class="seperator" data-v-21553e4a></div></div></p> <h2 id="什么是cookie"><a href="#什么是cookie" aria-hidden="true" class="header-anchor">#</a> 什么是cookie</h2> <p>Cookie是服务器给客户端发的一个 <code>通行证</code> 。</p> <p>每当访问服务器时都要携带自己的通行证，这样服务器就可以确定用户身份。</p> <blockquote><p>Cookie（复数形态Cookies），类型为「小型文本文件」，指某些网站为了辨别用户身份而储存在用户本地终端上的数据。——维基百科</p></blockquote> <p>cookie是一般不超过 4KB 的小型文本数据，它由一个名称（Name）、一个值（Value）和其它几个用于控制 Cookie 有效期、安全性、使用范围的可选属性组成。</p> <p>HTTP 是无状态的协议（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不 会保存任何会话信息），注意这里指的是HTTP1.x：每个请求都是完全独立的，服务端无法确认当前访问者的身份信息，无法分辨上一次的请求发送者和这一次的发送者是不是同一个人。即使同一个客户端连续两次发送请求给服务器，服务器也识别不出这是同一个客户端发送的请求。</p> <p>所以服务器与浏览器为了进行会话跟踪（知道是谁在访问我），就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求 是否来自同一浏览器。而这个状态需要通过 cookie 或者 session 去实现。</p> <p>cookie 存储在客户端： cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在 浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。</p> <h2 id="cookie长什么样子"><a href="#cookie长什么样子" aria-hidden="true" class="header-anchor">#</a> cookie长什么样子</h2> <p>可以在浏览器开发者工具中的Application里看到：</p> <p><img src="/assets/img/cookie.30edebba.png" alt=""></p> <p>但cookie 并不只是存放在浏览器里的。实际上，Cookie相关的内容还可以存在本地文件里，就比如说 Mac 下的 Chrome，存放目录就是 <code>~/Library/Application Support/Google/Chrome/Default</code> ，里面会有一个名为 Cookies 的数据库文件，我们可以使用 sqlite 软件打开它。</p> <h2 id="cookie怎么设置"><a href="#cookie怎么设置" aria-hidden="true" class="header-anchor">#</a> cookie怎么设置</h2> <ol><li>客户端发送 HTTP 请求到服务器</li> <li>当服务器收到 HTTP 请求时，在响应头里面添加一个 <code>Set-Cookie</code> 字段</li> <li>浏览器收到响应后保存下 Cookie</li> <li>之后对该服务器每一次请求中都通过 Cookie 字段将 Cookie 信息发送给服务器。</li></ol> <p>注意：要设置多个cookie时，得多写几个 <code>Set-Cookie</code> 。</p> <h2 id="cookie在请求流程中的-角色"><a href="#cookie在请求流程中的-角色" aria-hidden="true" class="header-anchor">#</a> cookie在请求流程中的'角色'</h2> <ol><li>用户 <code>baitang</code> 在浏览器端输入用户名密码, 发起POST请求到后端服务器。后端服务器验证合法，返回Response，并 <code>Set-Cookie</code> 为 <code>sessionid=***;username=baitang;</code> 。</li> <li>浏览器端在接收到HTTP响应后，发现 <code>Set-Cookie</code> ，将其存入本地内存或硬盘中。</li> <li>浏览器端再次发起请求，带上Cookie信息 <code>sessionid=***;username=baitang;</code> ，请求修改自己的头像信息。</li> <li>服务器根据 <code>sessionid</code> 验证当前用户已登陆，根据 <code>username</code> , 查找数据库中的对应数据，修改头像信息。</li></ol> <h2 id="cookie不可跨域"><a href="#cookie不可跨域" aria-hidden="true" class="header-anchor">#</a> cookie不可跨域</h2> <p>cookie 是不可跨域的： 每个 cookie 都会绑定单一的域名，无法在别的域名下获取使用，一级域名和二级域名之间是允许共享使用的（靠的是 domain）。</p> <h2 id="cookie的属性"><a href="#cookie的属性" aria-hidden="true" class="header-anchor">#</a> cookie的属性</h2> <p>cookie 的属性格式是 <code>name=value键值对</code> ，可以设置 Cookie 的名称及相对应的值，都必须是字符串类型。</p> <ul><li>如果值为 Unicode 字符，需要为字符编码。</li> <li>如果值为二进制数据，则需要使用 BASE64 编码。</li></ul> <p>从上图我们可以看到，cookie的属性有这些：</p> <ul><li><p><code>Name</code> : 该Cookie的 <code>名称</code> 。Cookie一旦创建，名称便不可更改。</p></li> <li><p><code>Value</code> : 该Cookie的 <code>值</code> 。</p></li> <li><p><code>Domain</code> : 设置可以访问该Cookie的 <code>域名</code> 。</p> <p>Domain 指定了 Cookie 可以送达的主机名。假如没有指定，那么默认值为当前文档访问地址中的主机部分（但是不包含子域名）。</p></li> <li><p><code>Path</code> : 该Cookie的 <code>使用路径</code> 。</p> <p>如果设置为“/test/”，则只有“http://xxx.xxx.xxx/test”的程序可以访问该Cookie。如果设置为“/”，则本域名下的程序都可以访问Cookie，注意最后一个字符必须为“/”。</p> <p>Domain 和 Path 标识共同定义了 Cookie 的作用域：即 Cookie 应该发送给哪些 URL。</p></li> <li><p><code>Expires</code> : 设置该 Cookie 的过期时间, 如： <code>2020-04-09T04:28:40.537Z</code> 。</p> <p>当 Expires 属性缺省时，表示是会话性 Cookie，像上图 Expires 的值为 Session，表示的就是 <code>会话性 Cookie</code> 。当为会话性 Cookie 的时候，值保存在客户端内存中，并 <code>在用户关闭浏览器时失效</code> 。需要注意的是，有些浏览器提供了 <code>会话恢复</code> 功能，这种情况下即使关闭了浏览器，会话期 Cookie 也会被保留下来，就好像浏览器从来没有关闭一样。</p> <p>与会话性 Cookie 相对的是持久性 Cookie，持久性 Cookies 会保存在用户的硬盘中，直至过期或者清除 Cookie。这里值得注意的是，设定的日期和时间只与客户端相关，而不是服务端。</p></li> <li><p><code>Max-Age</code> : 设置在 Cookie 失效之前需要经过的秒数.</p> <p>Max-Age 可以为正数、负数、甚至是 0。</p> <ul><li><p>如果 max-Age 属性为正数时，浏览器会将其持久化，即写到对应的 Cookie 文件中。</p></li> <li><p>当 max-Age 属性为负数，则表示该 Cookie 只是一个会话性 Cookie。</p></li> <li><p>当 max-Age 为 0 时，则会立即删除这个 Cookie。</p></li></ul> <p><strong>假如 Expires 和 Max-Age 都存在，Max-Age 优先级更高。</strong></p></li> <li><p><code>Size</code> : 该cookie的大小</p></li> <li><p><code>HttpOnly</code> : 设置 HTTPOnly 属性可以防止客户端脚本通过 document.cookie 等方式访问 Cookie，有助于避免 XSS 攻击。</p> <p>也就是说，这个Only，only在了cookie只能够在http协议中传输， 除此以外都不可以都不可以获取到cookie。当然你要是自己按下F12，点开application的cookies对某个cookie进行复制，那确实也能够获取到。。。</p> <p>tips：document.cookie可以对cookie进行读写：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//读取浏览器中的cookie</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//写入cookie</span>
  document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">'username=baitang;path=/;domain=.baidu.com'</span><span class="token punctuation">;</span>
</code></pre></div><p>如果某个 cookie 设置了 httpOnly 属性，则无法通过 JS 脚本 读取到该 cookie 的信息，但还是能通过 Application 中手动修改 cookie，所以只是在一定程度上可以防止 XSS 攻击，不是绝对的安全。</p> <ul><li><p>Secure: <code>是否仅使用安全协议传输</code> ，默认为false。</p> <p>标记为 Secure 的 Cookie 只应通过被HTTPS协议加密过的请求发送给服务端。使用 HTTPS 安全协议，可以保护 Cookie 在浏览器和 Web 服务器间的传输过程中不被窃取和篡改。</p></li> <li><p>SameSite: 可以让 Cookie 在跨站请求时不会被发送，从而可以阻止跨站请求伪造攻击（CSRF）。</p> <p>SameSite 可以有下面三种值：</p> <ol><li><strong>Strict</strong> ：仅允许第一方请求携带 Cookie，即浏览器将只发送同一站点请求的 Cookie，即<strong>当前网页 URL 与请求目标 URL 完全一致</strong>。</li></ol> <p>2.<strong>Lax</strong> ：只允许在 <code>get方法提交表单</code> 和 <code>a标签发送get请求</code> 请求携带 Cookie。</p> <ol start="3"><li><strong>None</strong> ：无论是否跨站，请求都会自动携带上 Cookie。</li></ol> <p><strong>之前默认是 <code>None</code> 的，Chrome80 后默认是 <code>Lax</code> 。</strong></p></li></ul> <h2 id="chrome80默认samesite"><a href="#chrome80默认samesite" aria-hidden="true" class="header-anchor">#</a> Chrome80默认SameSite</h2> <p><img src="/assets/img/SameSite.bfe6cf70.png" alt=""></p> <p>对大部分 web 应用而言，Post 表单，iframe，AJAX，Image 这四种情况从以前的跨站会发送三方 Cookie，变成了不发送。</p> <p>Post表单：应该的，学 CSRF 总会举表单的例子。</p> <p>iframe：iframe 嵌入的 web 应用有很多是跨站的，都会受到影响。</p> <p>AJAX：可能会影响部分前端取值的行为和结果。</p> <p>Image：图片一般放 CDN，大部分情况不需要 Cookie，故影响有限。但如果引用了需要鉴权的图片，可能会受到影响。</p> <p>除了这些还有 script 的方式，这种方式也不会发送 Cookie，像淘宝的大部分请求都是 jsonp，如果涉及到跨站也有可能会被影响。</p> <h3 id="跨域和跨站"><a href="#跨域和跨站" aria-hidden="true" class="header-anchor">#</a> 跨域和跨站</h3> <p>首先要理解的一点就是跨站和跨域是不同的。</p> <p>同站(same-site)/跨站(cross-site)」和第一方(first-party)/第三方(third-party)是等价的。但是与浏览器同源策略（SOP）中的「同源(same-origin)/跨域(cross-origin)」是完全不同的概念。</p> <p>同源策略的同源是指两个 URL 的协议/主机名/端口一致。例如，<a href="https://www.taobao.com/pages/" target="_blank" rel="noopener noreferrer">www.taobao.com/pages/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>... ，它的协议是 https，主机名是 www.taobao.com，端口是 443。</p> <p>同源策略作为浏览器的安全基石，其「同源」判断是比较严格的，相对而言，Cookie中的「同站」判断就比较宽松：只要两个 URL 的 eTLD+1 相同即可，不需要考虑协议和端口。其中，eTLD 表示有效顶级域名，注册于 Mozilla 维护的公共后缀列表（Public Suffix List）中，例如，.com、.co.uk、.github.io 等。eTLD+1 则表示，有效顶级域名+二级域名，例如 taobao.com 等。</p> <p>举几个例子，www.taobao.com 和 www.baidu.com 是跨站，www.a.taobao.com 和 www.b.taobao.com 是同站，a.github.io 和 b.github.io 是跨站(注意是跨站)。</p> <h2 id="如何修改删除cookie"><a href="#如何修改删除cookie" aria-hidden="true" class="header-anchor">#</a> 如何修改删除cookie</h2> <p><strong>修改</strong>：创建同名Cookie，覆盖原来的Cookie</p> <p><strong>删除</strong>：创建同名Cookie，并将maxAge属性设置为0</p> <h2 id="cookie的用处"><a href="#cookie的用处" aria-hidden="true" class="header-anchor">#</a> cookie的用处</h2> <ul><li>会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）</li> <li>个性化设置（如用户自定义设置、主题等）</li> <li>浏览器行为跟踪（如跟踪分析用户行为等）</li></ul> <h2 id="cookie的缺点"><a href="#cookie的缺点" aria-hidden="true" class="header-anchor">#</a> cookie的缺点</h2> <ol><li>性能上，Cookie 紧跟域名，在SameSite设置为None时，不管域名下面的某一个地址需不需要这个 Cookie ，请求都会携带上完整的 Cookie，这样随着请求数的增多，会造成巨大的性能浪费，因为请求携带了很多不必要的内容。但可以通过 <code>Domain</code> 和 <code>Path</code> 指定<strong>作用域</strong>来解决。</li> <li>访问上，cookie与浏览器相关，不能互相访问。</li> <li>安全上，cookie安全性不够高， Cookie 会在浏览器和服务器之间进行传递，很容易被截获从而进行篡改。</li> <li>容量上，cookie存储空间很小(只有4–10KB左右)。</li> <li>还有就是，cookie可能被用户删除。</li></ol> <h2 id="cookie的防篡改"><a href="#cookie的防篡改" aria-hidden="true" class="header-anchor">#</a> cookie的防篡改</h2> <h3 id="为什么cookie需要防篡改"><a href="#为什么cookie需要防篡改" aria-hidden="true" class="header-anchor">#</a> 为什么Cookie需要防篡改</h3> <p>为什么要做Cookie防篡改，一个重要原因是 <strong>Cookie中存储有判断当前登陆用户会话信息（Session）的会话票据-SessionID和一些用户信息</strong>。</p> <p>当发起一个HTTP请求，HTTP请求头会带上Cookie，Cookie里面就包含有SessionID。 后端服务根据SessionID，去获取当前的会话信息。如果会话信息存在，则代表该请求的用户已经登陆。 服务器根据登陆用户的权限，返回请求的数据到浏览器端。</p> <p>因为Cookie是存储在客户端，用户可以随意修改。所以，存在一定的安全隐患。</p> <h3 id="防篡改签名"><a href="#防篡改签名" aria-hidden="true" class="header-anchor">#</a> 防篡改签名</h3> <blockquote><p>服务器为每个Cookie项生成签名。如果用户篡改Cookie，则与签名无法对应上。以此，来判断数据是否被篡改。</p></blockquote> <p><strong>原理如下：</strong></p> <ul><li>服务端提供一个签名生成算法 <code>secret</code></li> <li>根据方法生成签名 <code>secret(baitang)=34Yult8i</code></li> <li>将生成的签名放入对应的Cookie项 <code>username=baitang|34Yult8i</code> 。其中，内容和签名用 <code>|</code> 隔开。</li> <li>服务端根据接收到的内容和签名，校验内容是否被篡改。</li></ul> <p>小栗子：</p> <p>比如服务器接收到请求中的Cookie项 <code>username=pony|34Yult8i</code> ，然后使用签名生成算法 <code>secret(pony)=666</code> 。 算法得到的签名 <code>666</code> 和请求中数据的签名不一致，则证明数据被篡改。</p> <h3 id="敏感数据的保护"><a href="#敏感数据的保护" aria-hidden="true" class="header-anchor">#</a> 敏感数据的保护</h3> <p>鉴于Cookie的安全性隐患，敏感数据都应避免存储在Cookie。 应该根据SessionID，将敏感数据存储在后端。取数据时，根据SessionID去后端服务器获取即可。 另外，对一些重要的Cookie项，应该生成对应的签名，来防止被恶意篡改。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">4/4/2020, 5:42:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/interview/004-js-7-inherits/" class="prev">
          004:JavaScript七大继承完爆面试
        </a></span> <span class="next"><a href="/interview/006-garbage-collection/">
          006:JS的垃圾回收机制
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.b1906b97.js" defer></script><script src="/assets/js/2.bdee5faf.js" defer></script><script src="/assets/js/12.450e705b.js" defer></script><script src="/assets/js/7.f0379e88.js" defer></script><script src="/assets/js/8.e132ed9d.js" defer></script>
  </body>
</html>
